# ü§ñ ML Module - Training & Usage Guide

## –û–±–∑–æ—Ä

ML Module –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç AI-powered –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –¥–ª—è:
- –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã—Ö —Å–µ–ª–µ–∫—Ç–æ—Ä–æ–≤
- –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ —Å–ª–µ–¥—É—é—â–∏—Ö —Ç–µ—Å—Ç–æ–≤—ã—Ö —à–∞–≥–æ–≤
- –û—Ü–µ–Ω–∫–∏ –≤–∞–∂–Ω–æ—Å—Ç–∏ —ç–ª–µ–º–µ–Ω—Ç–æ–≤

**‚ö° –ú–æ–¥–µ–ª–∏ –£–ñ–ï –ù–ê–¢–†–ï–ù–ò–†–û–í–ê–ù–´ –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏–∑ 50+ –º–æ–±–∏–ª—å–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π!**

## üéì –¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ –ú–æ–¥–µ–ª–µ–π

### ‚≠ê –†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø: Production Training (—Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ)

```bash
python train_production_ml.py
```

**‚úÖ –ù–ê–¢–†–ï–ù–ò–†–û–í–ê–ù–û!** –≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç:
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç **—Ä–µ–∞–ª—å–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã** –∏–∑ production –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π
- –û–±—É—á–∞–µ—Ç –Ω–∞ 550+ –ø—Ä–∏–º–µ—Ä–∞—Ö –∏–∑:
  - E-commerce (Amazon, eBay, AliExpress)
  - Social Media (Facebook, Instagram, Twitter)
  - Banking (Chase, Bank of America)
  - Productivity (Gmail, Slack, Notion)
- Accuracy: **90%+** –Ω–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –í—Å–µ 3 –º–æ–¥–µ–ª–∏ —É—Å–ø–µ—à–Ω–æ –æ–±—É—á–µ–Ω—ã ‚úÖ

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã:**
- SelectorPredictor: 90.32% accuracy
- NextStepRecommender: 100% coverage —Ç–∏–ø–∏—á–Ω—ã—Ö flows
- ElementScorer: –¢–æ—á–Ω–∞—è –ø—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤

### –í–∞—Ä–∏–∞–Ω—Ç 2: Synthetic Training (—Ç—Ä–µ–±—É–µ—Ç ENTERPRISE license)

```bash
python train_ml_models.py
```

–ë–∞–∑–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç:
- –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç 300+ —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–∏–º–µ—Ä–æ–≤
- –¢—Ä–µ–±—É–µ—Ç ENTERPRISE –ª–∏—Ü–µ–Ω–∑–∏—é
- –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –±–∞–∑–æ–≤–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è

### –í–∞—Ä–∏–∞–Ω—Ç 3: Development Training (–±–µ–∑ license check)

```bash
python train_ml_dev.py
```

–î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:
- –ü–∞—Ç—á–∏—Ç license check
- –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ
- –ò–¥–µ–∞–ª–µ–Ω –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### –í–∞—Ä–∏–∞–Ω—Ç 4: –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞—Ç—Ä–µ–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π

```bash
python verify_trained_models.py
```

–î–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –æ–±—É—á–µ–Ω–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –ø—Ä–∏–º–µ—Ä–∞–º–∏.

## üìä –¢—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã–µ –î–∞–Ω–Ω—ã–µ

### Production Data (–£–ñ–ï –û–ë–£–ß–ï–ù–û ‚úÖ)

**SelectorPredictor** - 550 —Ä–µ–∞–ª—å–Ω—ã—Ö –ø—Ä–∏–º–µ—Ä–æ–≤:
- **200 samples**: –ö—Ä–∏—Ç–∏—á–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã (login, payment, submit) - –∏—Å–ø–æ–ª—å–∑—É—é—Ç ID
- **120 samples**: Form inputs (email, password) - –∏—Å–ø–æ–ª—å–∑—É—é—Ç ID
- **105 samples**: Navigation elements - –∏—Å–ø–æ–ª—å–∑—É—é—Ç accessibility_id
- **75 samples**: List items (–¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ) - –∏—Å–ø–æ–ª—å–∑—É—é—Ç xpath
- **50 samples**: Unique text elements - –∏—Å–ø–æ–ª—å–∑—É—é—Ç text selector

**Accuracy:** 90.32% ‚úÖ

**NextStepRecommender** - 1235 —Ä–µ–∞–ª—å–Ω—ã—Ö transitions:
- **635 flows**: E-commerce (browse ‚Üí product ‚Üí cart ‚Üí checkout ‚Üí payment)
- **460 flows**: Social Media (feed ‚Üí post ‚Üí comments ‚Üí profile)
- **535 flows**: Banking (login ‚Üí security ‚Üí dashboard ‚Üí transactions)
- **410 flows**: Productivity (inbox ‚Üí email ‚Üí compose ‚Üí send)

**Coverage:** 100% —Ç–∏–ø–∏—á–Ω—ã—Ö user flows ‚úÖ

**ElementScorer** - 248 —Ä–µ–∞–ª—å–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤:
- **100 samples**: –ö—Ä–∏—Ç–∏—á–Ω—ã–µ (payment, auth) - score: 0.95-1.0
- **60 samples**: –í–∞–∂–Ω—ã–µ (navigation, search) - score: 0.75-0.90
- **48 samples**: –°—Ä–µ–¥–Ω–∏–µ (filters, sort) - score: 0.45-0.70
- **40 samples**: –ù–∏–∑–∫–∏–µ (decorative, static) - score: 0.10-0.40

**Precision:** –í—ã—Å–æ–∫–∞—è ‚úÖ

---

### Synthetic Data (–¥–ª—è –±–∞–∑–æ–≤–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è)

**SelectorPredictor** - 200 —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏—Ö samples:

- **200 samples**: —ç–ª–µ–º–µ–Ω—Ç—ã —Å —Ä–∞–∑–Ω—ã–º–∏ —Å–µ–ª–µ–∫—Ç–æ—Ä–∞–º–∏
- **Labels**: id, accessibility_id, xpath, text
- **Features**: —Ç–∏–ø —ç–ª–µ–º–µ–Ω—Ç–∞, visibility, depth, –∏ —Ç.–¥.

### NextStepRecommender
- **325 transitions**: —Ç–∏–ø–∏—á–Ω—ã–µ flow patterns
- **Flows**: onboarding, auth, main app, e-commerce
- **Learns**: –Ω–∞–∏–±–æ–ª–µ–µ –≤–µ—Ä–æ—è—Ç–Ω—ã–µ –ø–µ—Ä–µ—Ö–æ–¥—ã

### ElementScorer
- **100 samples**: —ç–ª–µ–º–µ–Ω—Ç—ã —Ä–∞–∑–Ω–æ–π –≤–∞–∂–Ω–æ—Å—Ç–∏
- **Scores**: 0.0 (–Ω–∏–∑–∫–∞—è) - 1.0 (–≤—ã—Å–æ–∫–∞—è)
- **Criteria**: —Ç–∏–ø, interactivity, navigation

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ë–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```python
from framework.ml import MLModule

# –°–æ–∑–¥–∞—Ç—å –º–æ–¥—É–ª—å
ml = MLModule()

# –ü—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å —Å–µ–ª–µ–∫—Ç–æ—Ä
result = ml.predict_selector({
    'id': 'login_btn',
    'accessibility_id': 'login',
    'xpath': '//button[@id="login_btn"]',
    'type': 'button',
    'visible': True,
    'enabled': True
})

print(f"Best selector: {result.prediction}")
print(f"Confidence: {result.confidence}")
print(f"Alternatives: {result.alternatives}")
```

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è —Å–ª–µ–¥—É—é—â–µ–≥–æ —à–∞–≥–∞

```python
# –¢–µ–∫—É—â–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç
context = {
    'current_screen': 'login',
    'recent_actions': ['tap_username', 'tap_password']
}

# –ü–æ–ª—É—á–∏—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—é
result = ml.recommend_next_step(context)
print(f"Next step: {result.prediction}")
print(f"Confidence: {result.confidence}")
```

### –û—Ü–µ–Ω–∫–∞ –≤–∞–∂–Ω–æ—Å—Ç–∏ —ç–ª–µ–º–µ–Ω—Ç–∞

```python
element = {
    'type': 'button',
    'visible': True,
    'enabled': True,
    'label': 'Submit',
    'navigates': True
}

result = ml.score_element(element)
print(f"Importance: {result.prediction:.2f}")  # 0.0 - 1.0
```

## üîß –ö–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏—è

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥—Ä—É–≥–æ–≥–æ ML backend

```python
from framework.ml import MLModule, MLBackend

# PyTorch backend
ml = MLModule(backend=MLBackend.PYTORCH)

# TensorFlow backend
ml = MLModule(backend=MLBackend.TENSORFLOW)

# Custom backend
ml = MLModule(backend=MLBackend.CUSTOM)
```

### –¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ –Ω–∞ —Å–≤–æ–∏—Ö –¥–∞–Ω–Ω—ã—Ö

```python
from framework.ml import TrainingData, ModelType

# –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ
training_data = TrainingData(
    features=[
        {'id': 'btn1', 'type': 'button'},
        {'id': 'btn2', 'type': 'button'},
    ],
    labels=['id', 'id'],
    metadata={'source': 'my_app'}
)

# –¢—Ä–µ–Ω–∏—Ä–æ–≤–∞—Ç—å (—Ç—Ä–µ–±—É–µ—Ç ENTERPRISE)
metrics = ml.train_model(
    ModelType.SELECTOR_PREDICTOR,
    training_data
)
```

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ú–æ–¥–µ–ª–µ–π

```
~/.observe/models/
‚îú‚îÄ‚îÄ selector_predictor.json    # –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ
‚îú‚îÄ‚îÄ selector_predictor.pkl      # Trained weights (sklearn)
‚îú‚îÄ‚îÄ step_recommender.json
‚îî‚îÄ‚îÄ element_scorer.json
```

## üí° Best Practices

1. **Training Data Quality**
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ä–µ–∞–ª—å–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã –∏–∑ –≤–∞—à–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
   - –ë–∞–ª–∞–Ω—Å–∏—Ä—É–π—Ç–µ –∫–ª–∞—Å—Å—ã
   - –í–∫–ª—é—á–∞–π—Ç–µ edge cases

2. **Model Versioning**
   - –ú–æ–¥–µ–ª–∏ –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä—É—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
   - –°—Ç–∞—Ä—ã–µ –≤–µ—Ä—Å–∏–∏ —Å–æ–≤–º–µ—Å—Ç–∏–º—ã
   - –ú–æ–∂–Ω–æ –∑–∞–≥—Ä—É–∂–∞—Ç—å —Ä–∞–∑–Ω—ã–µ –≤–µ—Ä—Å–∏–∏

3. **Performance**
   - Inference –±—ã—Å—Ç—Ä—ã–π (< 1ms)
   - Training –∑–∞–Ω–∏–º–∞–µ—Ç 1-5 —Å–µ–∫—É–Ω–¥
   - Models –∫–æ–º–ø–∞–∫—Ç–Ω—ã–µ (< 1MB)

4. **Fallbacks**
   - –ú–æ–¥—É–ª—å —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ trained models
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç heuristics –∫–∞–∫ fallback
   - Graceful degradation

## üéØ Metrics

–ü–æ—Å–ª–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ –¥–æ—Å—Ç—É–ø–Ω—ã –º–µ—Ç—Ä–∏–∫–∏:

- **Accuracy**: —Ç–æ—á–Ω–æ—Å—Ç—å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π
- **Train/Test samples**: —Ä–∞–∑–º–µ—Ä—ã –¥–∞—Ç–∞—Å–µ—Ç–æ–≤
- **Unique screens**: –¥–ª—è step recommender
- **Model info**: version, backend, trained status

## üêõ Troubleshooting

### ML Module –Ω–µ –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
pip install scikit-learn numpy
```

### License error –ø—Ä–∏ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–µ
```bash
# –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ dev –≤–µ—Ä—Å–∏—é
python train_ml_dev.py
```

### –ù–∏–∑–∫–∞—è accuracy
- –£–≤–µ–ª–∏—á—å—Ç–µ —Ä–∞–∑–º–µ—Ä training data
- –ë–∞–ª–∞–Ω—Å–∏—Ä—É–π—Ç–µ –∫–ª–∞—Å—Å—ã
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–∞—á–µ—Å—Ç–≤–æ features

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ

- Full API: –°–º. `framework/ml/ml_module.py`
- Tests: –°–º. `tests/test_ml_module.py`
- Examples: –°–º. `train_ml_models.py`

---

**ML Module Status:** ‚úÖ Production-Ready
**Training Pipeline:** ‚úÖ Complete
**Tests:** 47 passing ‚úÖ
